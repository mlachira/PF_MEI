---
title: "Tarea_SIKA"
output: html_document
date: "2023-10-04"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(deSolve)
```

### ¿Qué es el Zika?

La fiebre de Zika es una enfermedad viral causada por el virus de Zika (ZIKV) que se transmite principalmente por el mosquito Aedes.

### Historia

Este virus fue descubierto en 1947 en el bosque de Zika en Uganda, en 1952 se detectaron los primeros casos y posteriormente comenzaron los brotes en la región tropical de Áfricas, sudeste asiáticos y las islas del Pacífico.

### Propagación 

La mayor causa de propagación es por picadura del mosquito Aedes pero también se puede propagar por medio de una mujer embarazada a su feto, relaciones sexuales y transfuciones de sangre.

### Sintomatología 

Los síntomas comienzan entre 2 a 7 días después de la picadura de mosquitos. Entre los síntomas de Sika esta fiebre, sarpullido, dolor de cabeza, dolor en las articulaciones, ojos rojos, dolor de cuerpo. 1 de 4 personas pueden desarrollar estos síntomas y tener una duración de 2 a 7 días.

Las personas no generan una enfermedad grave y muy pocas veces mueren a causar de este virus.

### Modelo SIR en humanos

El modelo SIR (susceptible- infectado- recuperado), vamos a tener 3 compartimiento el de susceptibles que son los individuos sin la enfermedad, infectados que son los individuos con la enfermedad y tiene la posibilidad de infectar a los suceptibles y recuperados que son aquellos indivuos que recuperados de la enfermedad.

Los susceptibles solo van a poder pasar a ser infectados si hay una interacción entre el individuo susceptible con los infectados, los individuos infectados pueden pasar a ser individuos recuperados y estos ya no pasan a ser susceptibles, esto puede ser porque se genere inmunidad. 

De parametros vamos a tener β (Beta) que es la tasa de contagio (suceptibles pasan a infectados) y ɣ (Gamma) que es la tasa en la que pasan de infectados a recuperados

### Modelo SEI en mosquitos

El modelo SEIR (susceptible - expuesto - infectado), es un modelo con 3 compartimientos, uno es el susceptibles donde estan los individuos que no cuentan con la enfermedad, expuestos donde son los individuos que portan la enfermedad pero no muestran síntomas debido a que puede estar en periodo de incubación o pueden estar en condiciones de no infectar a otros y los infecciosos son los individuos infectados y que pueden transmitir la enfermedad 

Para que un individuo susceptible pase a ser uno expuesto debió de haber una interacción de un susceptible e infectados, cuando pasan a ser expuesto este puede pasar a infectados.

De parámetros tenemos a β (Beta) determina la tasa de contagio y δ (Delta) es la tasa de recuperación 

Ámbos son con demografía por lo que se considera mu como mi tasa de natalidad y mortalidad

El siguiente modelo es el visto en la clase.

$$
\begin{array}{l}
\dot{S}_h=-\beta_h S_h I_v+ \mu h- \mu h S_h \\
\dot{I}_h=\beta_h S_h I_v- \mu h I_h- \gamma_h I_h \\
\dot{R}_h= \gamma_h I_h- \mu h R_h
\end{array}
$$

$$
\begin{array}{l}
\dot{S}_v=-\beta_v S_v I h- \mu v S_v+ \mu v \\
\dot{E}_v=\beta_v S_v I h-\mu v E_v- \delta E_v \\
\dot{I}_v= \delta E_v- \mu v I_v
\end{array}
$$

En donde:

* Sh es mi población suceptible en humanos. 
* Ih son los humanos infectados con el virus de Sika y pueden contagiar a otros.
* Rh son los humanos recuperados de la enfermedad.
* Sv mi población suceptible en mosquitos. 
* Ev los mosquitos que estan en periodo de incubación o pueden estar en condiciones de no infectar a otros.
* Iv son los mosquitos infectados con el virus de Sika y pueden contagiar a otros.
* β es la tasa de contagio.
* ɣ es la tasa de recuperción.
* δ es la tasa de expuestos a infectados.
* µ tasa de mortalidad/ natalidad


![Modelo visto en clase de Sika](Modelo.png)

Esta es la primera función que hice con las ecuaciones que escribimos en la clase

```{r}
SIKA_M <- function(t, state, parameters) {
  with(as.list(c(state, parameters)), {
    #Ecuaciones humanos
dSh<- -beta*Sh*Iv/(Sh+Ih+Rh) -mu*Sh +muh
dIh<- beta*Sh*Iv/(Sh+Ih+Rh) -gama*Ih -mu*Ih
dRh<- gama*Ih -mu*Rh
#Ecuaciones vectores
dSv<- -beta*Sv*Ih/(Sv+Ev+Iv) -mu*Sv +muv
dEv<- beta*Sv*Ih/(Sv+Ev+Iv) -mu*Ev -delta*Ev
dIv<- delta*Ev -mu*Iv
list(c(dSh, dIh, dRh, dSv, dEv, dIv))
})
}

```
 
## Práctica de Sika

Esta es la función con los parametros de la práctica que se proyecto en la clase

```{r}
ZIKA_P <- function(times, state, pars) {
  with(as.list(c(state, pars)), {
    #Ecuaciones humanos
dSh<- -(betah*b)*Sh*Iv -muh*Sh +muh
dIh<- (betah*b)*Sh*Iv -gamma*Ih -muh*Ih
dRh<- gamma*Ih -muh*Rh
#Ecuaciones vectores
dSv<- -(betav*b)*Sv*Ih -muv*Sv +muv
dEv<- (betav*b)*Sv*Ih -delta*Ev -muv*Ev
dIv<- delta*Ev -muv*Iv
list(c(dSh, dIh, dRh, dSv, dEv, dIv))
  })
}

```


Consideramos los siguientes parametros: 

* Lv<- Espernaza de vida de los mosquitos (días)
* Lh<- Esperanza de vida de los humanos (días)
* Iph<- Periodo infeccioso en humanos (días)
* Ip<- Periodo infeccioso en vectores (días)
* EIP<- Periodo de incubación extrínseco en mosquitso adultos (días)
* muv<- Mortalidad en mosquitos
* muh<- Mortalidad en humanos
* gamma<- Tasa de recuperación en humanos
* delta<- Tasa de incubación extrínseca
* Nh<- Número de humanos (Población en Cali, Colombia)
* m<- Proporción vector a humano
* Nv<- Número de vectores
* betah<- Probabilidad de transmición del vector al hospedero
* betav<- Probabilidad de transmición del hospedero al vector 
* R0<- Número reproductivo 
* b<- Tasa de picadura


```{r}
#Parametros de la práctica 
Lv= 10
Lh= 50*235
Iph= 7
Ip= 6
EIP= 8.4
muv= 1/Lv
muh= 1/Lh
gamma= 1/Iph
delta= 1/EIP
Nh= 2.4*10^6
m= 2
Nv= m*Nh
betah= 0.7
betav= 0.7
R0= 3
b= sqrt((R0 ^2 * muv*(muv+delta) * (muh+gamma)) /(m * betah * betav * delta)) 

parz<- c(muv, muh, gamma, delta, betah, betav, Nh, Nv, b)
state <- c(Sh=2399999, Ih=1, Rh=0, Sv=4799998, Ev=0, Iv=2)
times <- seq(0, 100, by = 1)
out_SIKA <- ode(state, times, ZIKA_P, parz)
plot(out_SIKA, col="blue")

```

Podemos observar que la tasa de contagio en humanos y el vector es alta debido a que nuestros suceptibles se infectan rápido, de igual manera los infectados humanos se recuperan rápido y estos adquieren cierta inmunidad. De igual manera se puede explicar que la Iv baja debido a que la tasa de mortalidad en los moscos es alta, en este modelo no se considera que los mosquitos se recuperen si no que se considera que se quedan infectados hasta que se mueren por lo que la disminución en Iv no se la podemos atribuir a una inmunidad.

```{r}
grafica_zika <- matplot(out_SIKA[ , 1], out_SIKA[ , 2:7], type="l", xlab = "tiempo", ylab = "Población", 
        main= "ZIKA", lwd = 2) 
legend("topright", c("Sh", "Sv", "Ih", "Ev","Rh","Iv"), col =1:6, lty=1:6, cex=0.5)
```

```{r}
#Cambiando el tiempo a 20
times <- seq(0, 20, by = 1)
out_SIKA <- ode(state, times, ZIKA_P, parz)
plot(out_SIKA, col="red")

```

```{r}
grafica_zika <- matplot(out_SIKA[ , 1], out_SIKA[ , 2:7], type="l", xlab = "tiempo", ylab = "Población", 
        main= "ZIKA", lwd = 2) 
legend("topright", c("Sh", "Sv", "Ih", "Ev","Rh","Iv"), col =1:6, lty=1:6, cex=0.5)
```

## Artículo de = Mathematical model of zika virus dynamics with vector control and sensitivity analysis

[Mathematical model of zika virus dynamics with vector control and sensitivity analysis](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6940694/)

Enconte un árticulo en donde se usan diferentes parametros y valores de esto para construir un modelo de la dinamica del virus de SIKA. Solo cambie los valores de los parametros, no cambie las ecuaciones 

```{r}
###Con valores del artículo

parz_a<- c(betah=0.04441746	, betav=0.04791129, gamma=0.07098011, delta=0.02070591, muh=0.00019204, muv= 0.00019204, b=0.45)
state_a<- c(Sh= 1000, Ih= 4,Rh=0, Sv=4000, Ev=500, Iv=100)
times <- seq(0, 100, by = 1)
out_SIKA_a <- ode(state_a, times, ZIKA_P, parz_a)
plot(out_SIKA_a, col="green")
```

Aquí podemos observar que también hay una tasa alta de contagio por lo que los suceptibles pasan Ih o Ev. A diferencia de los valores que se usaron en el anterior los Iv se mantienen, los moscos se quedan infectados y llega a su punto de equilibro.

```{r}
grafica_zika <- matplot(out_SIKA_a[ , 1], out_SIKA_a[ , 2:7], type="l", xlab = "tiempo", ylab = "Población", 
        main= "ZIKA", lwd = 2) 
#legend("topright", c("Sh", "Sv", "Ih", "Ev","Rh","Iv"), col =1:6, lty=1:6, cex=0.5)
```

```{r}
times <- seq(0, 400, by = 2)
out_SIKA_a <- ode(state_a, times, ZIKA_P, parz_a)
plot(out_SIKA_a, col="green")
```

```{r}
grafica_zika <- matplot(out_SIKA_a[ , 1], out_SIKA_a[ , 2:7], type="l", xlab = "tiempo", ylab = "Población", 
        main= "ZIKA", lwd = 2) 
```

### Todas las formas de transmición

En el modelo 2 considere las tres fromas de transmición del virus de Zika. 

1) Transmición por el vector mosquito Aedes

2) Transmición de madre a feto

3) Transmición por relaciones sexuales

En base al árticulo mencionado anteriormente solo considera forma de transmición el contacto sexual y por picadura de mosco, sin embargo no considera los bebes que nacen infectados por lo que intente hacer el modelo en donde si se considerara (Solo fue un intento porque no se como poner en las ecuaciones la transmición vertical)

µhSb<- proporción de los que nacen infectados

![Modelo 2](Modelo 2.png)
$$
\begin{array}{l}
\dot{S}_h=-\beta_1 S_h I_v -\beta_2 S_h I_h + \mu_h p\\
\dot{I}_h=\beta_1 S_h I_v +\beta_2 S_h I_h - \mu_h (1-p)- \gamma_h I_h \\
\dot{R}_h= \gamma_h I_h- \mu h R_h
\end{array}
$$

$$
\begin{array}{l}
\dot{S}_v=-\beta_v S_v I h - \mu v S_v+ \mu v \\
\dot{E}_v=\beta_v S_v I_h -\mu v E_v- \delta E_v \\
\dot{I}_v= \delta E_v- \mu v I_v
\end{array}
$$

