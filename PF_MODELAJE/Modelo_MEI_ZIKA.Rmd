---
title: "Modelo_ZIKA_Completo"
author: "Melisa Lachira Maya"
date: "2023-11-17"
output: html_document
---
# Modelo ZIKA

## Formulas

$$
\begin{array}{l}
\dot{S}_h=-\beta_1 S_h I_v -\beta_2 S_h I_h + v_h p- \mu_h S_h \\
\dot{E}_h=\beta_1 S_h I_v +\beta_2 S_h I_h -\delta_h E_h -\mu_h E_h \\
\dot{I}_h= \delta_h E_h - \gamma_h I_h + v_h (1-p) - \mu_h I_h\\
\dot{R}_h= \gamma_h I_h- \mu h R_h
\end{array}
$$

$$
\begin{array}{l}
\dot{S}_v=-\beta_v S_v I_h - \mu_vS_v+ v_v \\
\dot{E}_v=\beta_v S_v I_h -\mu_v E_v- \delta E_v \\
\dot{I}_v= \delta E_v- \mu v I_v
\end{array}
$$

```{r}
library(deSolve)
ZIKA_M <- function(times, state, pars) {
  with(as.list(c(state, pars)), {
    #Ecuaciones humanos
    dSh<- -beta1*Sh*Iv -beta2*Sh*Ih +vh*p -muh*Sh
    dEh<- beta1*Sh*Iv +beta2*Sh*Ih -deltah*Eh -muh*Eh
    dIh<- deltah*Eh -gammah*Ih +vh*(1-p) -muh*Ih
    dRh<- gammah*Ih -muh*Rh
    #Ecuaciones vectores
    dSv<- -betav*Sv*Ih -muv*Sv +vv
    dEv<- betav*Sv*Ih -deltav*Ev -muv*Ev
    dIv<- deltav*Ev -muv*Iv
    list(c(dSh, dEh, dIh, dRh, dSv, dEv, dIv))
  })
}
```

```{r}
#tiempo
times<- seq(1, 200 , by = 1)
#Parametros
parametro<- c(beta1 =0.6,beta2 =0.5, muh =0.4, vh =0.5, deltah = 0.7, gammah = 0.2, betav = 0.7, muv = 0.5, vv = 0.3, deltav = 0.2, p=0.2)
#Condiciones iniciales
cond_ini<-c(
  Sh =10,
  Eh =2,
  Ih =1,
  Rh =1,
  Sv =10,
  Ev =5,
  Iv =3
)

```

```{r}

out <- ode(y=cond_ini,
           times=times,
           fun = ZIKA_M, 
           parms  = parametro)

plot(out,col="pink")
par(mfrow=c(1,1))

graficaTG <- matplot(out[ , 1], out[ , 2:8], type="l", xlab = "tiempo", ylab = "Población", 
                     main= "Gráfica ZIKA", lwd = 2) 
legend("topright", c("Sh", "Eh", "Ih", "Rh", "Sv", "Ev", "Iv"), col =1:5, lty=1:5, cex=0.5)
```

