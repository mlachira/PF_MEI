---
title: "Modelo_ZIKA_Completo"
author: "Melisa Lachira Maya"
date: "2023-11-17"
output: html_document
---
# Modelo ZIKA

## Formulas

Alto riesgo

Vectores

Bajo riesgo


```{r}
library(deSolve)
ZIKA_M <- function(times, state, pars) {
  with(as.list(c(state, pars)), {
    #Ecuaciones alto riesgo
    dS_H<- n_H*f*p_H - beta2*S_H*I_H*q - beta2*S_H*I_L - beta4*S_H*I_V - muh*S_H
    dE_H<- beta2*S_H*I_H*q + beta2*S_H*I_L + beta4*S_H*I_V - muh*E_H - alfa_H*E_H
    dI_H<- alfa_H*E_H + n_H*(1-p_H) - muh*I_H - tetha*I_H - gamma*I_H
    dR_H<- gamma*I_H - muh*R_H
    #Ecuaciones vectores
    dS_V<- n_V - beta3*S_V*I_L - beta5*S_V*I_H - muv*S_V
    dE_V<- beta3*S_V*I_L + beta5*S_V*I_H - muv*E_V - alfa_V*E_V
    dI_V<- alfa_V*E_V - muv*I_V
    #Ecuaciones bajo riesgo
    dS_L<- n_H*(1-f)*p_H - beta2*S_L*I_L*q - beta1*S_L*I_V - beta2*S_L*I_H - muh*S_L
    dE_L<- beta2*S_L*I_L*q + beta1*S_L*I_V + beta2*S_L*I_H - muh*E_L - alfa_H*E_L
    dI_L<- alfa_H*E_L + n_H*(1-p_H) - muh*I_L - tetha*I_L - gamma*I_L
    dR_L<- gamma*I_L - muh*R_L
    list(c(dS_H, dE_H, dI_H, dR_H, dS_V, dE_V, dI_V, dS_L, dE_L, dI_L, dR_L))
  })
}

```

```{r}
# TIEMPO
times<- seq(1, 200 , by = 1)

# CONDICIONES INICIALES
cond_ini<-c( 
  S_H = 0,
  E_H = 0,
  I_H = 0,
  R_H = 0,
  S_V = 0,
  E_V = 0,
  I_V = 0,
  S_L = 0,
  E_L = 0, 
  I_L = 0,  
  R_L = 0)


# PARAMETROS
parametro<- c(
Lv <- 8.5 + 35, #Esperanza de vida de mosquitos (dias)
Lh <- 0, # Esperanza de vida de humanos (dias) #### MODIFICAR POR EDO ####
iph <- 8.5, # Periodo de incubacion en humanos (dias)
ipv <- 8.5, # Periodo de incubacion en mosquito (dias)
ifh <- 4.5, # Periodo infeccioso en humanos (dias)
muh <- 0.0016, # Mortalidad en humanos 
muv <- 0.0064, # Mortalidad en vectores 
alfa_H <- 1/iph, # Tasa de incubacion en humanos 
alfa_V <- 1/ipv, # Tasa de incubacion en mosquitos
gamma <- 1/ifh, # Tasa de recuperacion en humanos 
n_H <- 0, # Tasa de natalidad humanos ##### MODIFICAR POR EDO ####
n_V <- 0.099, # Tasa de natalidad mosquitos 
tetha <- 0.005, # Tasa de letalidad asociada a zika
q <- 0.25, # Proporcion de la poblacion que usa condon #### ESTIMADO ####
p_H <- 0.867, #   Proporcion de la poblacion que nace libre de zika 
f <- 0, # Proporcion de nacidos que se dirigen al grupo de alto riesgo #### ESTIMADO ####
b <- 0.45, #Tasa de picadura de mosquito
a1 <- 0.044, # Probabilidad de transmision, picadura de mosquito infectado a humano susceptible de bajo riesgo (LV)
a2 <- 0.047, # Probabilidad de transmision, picadura de mosquito susceptible a humano infectado de bajo riesgo (VL)
a3 <- 0.033, # Probabilidad de transmision por contacto sexual entre humanos susceptibles e infectados (S-I humanos)
a4 <- 0.0616, # Probabilidad de transmision, mosquito infectado a humano susceptible de alto riesgo (HV)
a5 <- 0.0658, # Probabilidad de transmision, mosquito susceptible a humano infectado de alto riesgo (VH)
c <- 0.0055, # contacto sexual entre humano susceptible y humano infectado 
Nh <- 0, # Poblacion total de humanos  #### MODIFICAR POR EDO ####
beta1 <- (b*a1*I_V)/Nh, # Tasa de contagio mosquito infectado a persona susceptible de bajo riesgo
beta2 <- ((c*a3*(I_H + I_L))/(Nh)), # Tasa de contagio de persona infectada a persona susceptible  
beta3 <- ((b*a2*(I_L))/(Nh)), # Tasa de contagio persona infectada de bajo riesgo a mosquito susceptible
beta4 <- ((b*a4*I_V)/(Nh)), # Tasa de contagio mosquito infectado a persona susceptible de alto riesgo 
beta5 <- ((b*a5*(I_H))/(Nh)) # Tasa de contagio persona infectada de alto riesgo a mosquito susceptible
    )


```

```{r}

out <- ode(y=cond_ini,
           times=times,
           fun = ZIKA_M, 
           parms  = parametro)

plot(out,col="pink")
par(mfrow=c(1,1))

graficaTG <- matplot(out[ , 1], out[ , 2:8], type="l", xlab = "tiempo", ylab = "Población", 
                     main= "Gráfica ZIKA", lwd = 2) 
legend("topright", c("Sh", "Eh", "Ih", "Rh", "Sv", "Ev", "Iv"), col =1:5, lty=1:5, cex=0.5)
```


Para Querétaro
```{r}
times<- seq(1, 200 , by = 1)

    cond_ini<-c( 
      S_H = 700000,
      E_H = 12000,
      I_H = 10000,
      R_H = 6000,
      S_V = 9000,
      E_V = 400,
      I_V = 3000,
      S_L = 300000,
      E_L = 8000, 
      I_L = 10000,  
      R_L = 4000)
  
  # PARAMETROS
    parametro<- c(
      Lv <- 8.5 + 35, #Esperanza de vida de mosquitos (dias)
      Lh <- 75.9* 365, # Esperanza de vida de humanos (dias) #### MODIFICAR POR EDO ####
      iph <- 8.5, # Periodo de incubacion en humanos (dias)
      ipv <- 8.5, # Periodo de incubacion en mosquito (dias)
      ifh <- 4.5, # Periodo infeccioso en humanos (dias)
      muh <- 0.0016, # Mortalidad en humanos 
      muv <- 0.0064, # Mortalidad en vectores 
      alfa_H <- 1/iph, # Tasa de incubacion en humanos 
      alfa_V <- 1/ipv, # Tasa de incubacion en mosquitos
      gamma <- 1/ifh, # Tasa de recuperacion en humanos 
      n_H <- 0.0463, # Tasa de natalidad humanos ##### MODIFICAR POR EDO ####
      n_V <- 0.099, # Tasa de natalidad mosquitos 
      tetha <- 0.005, # Tasa de letalidad asociada a zika
      q <- 0.25, # Proporcion de la poblacion que usa condon #### ESTIMADO ####
      p_H <- 0.867, #   Proporcion de la poblacion que nace libre de zika 
      f <- 0.75, # Proporcion de nacidos que se dirigen al grupo de alto riesgo #### ESTIMADO ####
      b <- 0.45, #Tasa de picadura de mosquito
      a1 <- 0.044, # Probabilidad de transmision, picadura de mosquito infectado a humano susceptible de bajo riesgo (LV)
      a2 <- 0.047, # Probabilidad de transmision, picadura de mosquito susceptible a humano infectado de bajo riesgo (VL)
      a3 <- 0.033, # Probabilidad de transmision por contacto sexual entre humanos susceptibles e infectados (S-I humanos)
      a4 <- 0.0616, # Probabilidad de transmision, mosquito infectado a humano susceptible de alto riesgo (HV)
      a5 <- 0.0658, # Probabilidad de transmision, mosquito susceptible a humano infectado de alto riesgo (VH)
      c <- 0.0055, # contacto sexual entre humano susceptible y humano infectado 
      Nh <- 1050000, # Poblacion total de humanos  #### MODIFICAR POR EDO ####
      beta1 <- (b*a1*I_V)/Nh, # Tasa de contagio mosquito infectado a persona susceptible de bajo riesgo
      beta2 <- ((c*a3*(I_H + I_L))/(Nh)), # Tasa de contagio de persona infectada a persona susceptible  
      beta3 <- ((b*a2*(I_L))/(Nh)), # Tasa de contagio persona infectada de bajo riesgo a mosquito susceptible
      beta4 <- ((b*a4*I_V)/(Nh)), # Tasa de contagio mosquito infectado a persona susceptible de alto riesgo 
      beta5 <- ((b*a5*(I_H))/(Nh)) # Tasa de contagio persona infectada de alto riesgo a mosquito susceptible
    )

    
    out <- ode(y=cond_ini,
               times=times,
               fun = ZIKA_M, 
               parms  = parametro)
    
    plot(out,col="blue")
    par(mfrow=c(1,1))
    
    graficaTG <- matplot(out[ , 1], out[ , 2:12], type="l", xlab = "tiempo", ylab = "Población", 
                         main= "Gráfica ZIKA", lwd = 2) 
    legend("topright", c("Sh", "Eh", "Ih", "Rh", "Sv", "Ev", "Iv", "Sl", "El", "Il", "Rl"), col =1:5, lty=1:5, cex=0.5)
    
    
contact_rate_ZK<- (beta1 + beta2 + beta3 + beta4 + beta5)
transmission_probability_ZK<- (a1 + a2 + a3 + a4 + a5)
infectious_period_ZK<- ifh
RO= contact_rate_ZK * transmission_probability_ZK * infectious_period_ZK
c("RO=", R0)
    
```






EJERCICIO PARA CIUDAD DE MEXICO 
```{r}
  # TIEMPO CDMX
  tiempo_cdmx<- seq(1, 100 , by = 1)
  
  # CONDICIONES INICIALES CDMX
  iniciales_cdmx<-c( 
    S_H = 60000000, # 100 millones
    E_H = 9000000, # 16 millones
    I_H = 5500000,
    R_H = 1000000,
    
    S_V = 3758900,
    E_V = 2008900,
    I_V = 4578600,
    
    S_L = 40000000,
    E_L = 7000000, 
    I_L = 4000000,  
    R_L = 200000)
  
  # PARAMETROS (para ciudad de mexico)
  pars_cdmx <- c(
    Lv <- 8.5 + 35, #Esperanza de vida de mosquitos (dias)
    Lh <- 75*365, # Esperanza de vida de humanos (dias) #### MODIFICAR POR EDO ####
    iph <- 8.5, # Periodo de incubacion en humanos (dias)
    ipv <- 8.5, # Periodo de incubacion en mosquito (dias)
    ifh <- 4.5, # Periodo infeccioso en humanos (dias)
    muh <- 0.0016, # Mortalidad en humanos 
    muv <- 0.0064, # Mortalidad en vectores 
    alfa_H <- 1/iph, # Tasa de incubacion en humanos 
    alfa_V <- 1/ipv, # Tasa de incubacion en mosquitos
    gamma <- 1/ifh, # Tasa de recuperacion en humanos 
    n_H <- 0.0545, # Tasa de natalidad humanos ##### MODIFICAR POR EDO ####
    n_V <- 0.099, # Tasa de natalidad mosquitos 
    tetha <- 0.005, # Tasa de letalidad asociada a zika 
    q <- 0.25, # Proporcion de la poblacion que usa condon
    p_H <- 0.867, #   Proporcion de la poblacion que nace libre de zika 
    f <- 0.47, # Proporcion de nacidos que se dirigen al grupo de alto riesgo #### ESTIMADO ####
    b <- 0.45, #Tasa de picadura de mosquito
    a1 <- 0.044, # Probabilidad de transmision, picadura de mosquito infectado a humano susceptible de bajo riesgo (LV)
    a2 <- 0.047, # Probabilidad de transmision, picadura de mosquito susceptible a humano infectado de bajo riesgo (VL)
    a3 <- 0.033, # Probabilidad de transmision por contacto sexual entre humanos susceptibles e infectados (S-I humanos)
    a4 <- 0.0616, # Probabilidad de transmision, mosquito infectado a humano susceptible de alto riesgo (HV)
    a5 <- 0.0658, # Probabilidad de transmision, mosquito susceptible a humano infectado de alto riesgo (VH)
    c <- 0.0055, # contacto sexual entre humano susceptible y humano infectado 
    Nh <- 126700000, # Poblacion total de humanos  #### MODIFICAR POR EDO ####
    beta1 <- (b*a1*I_V)/Nh, # Tasa de contagio mosquito infectado a persona susceptible de bajo riesgo
    beta2 <- ((c*a3*(I_H + I_L))/(Nh)), # Tasa de contagio de persona infectada a persona susceptible  
    beta3 <- ((b*a2*(I_L))/(Nh)), # Tasa de contagio persona infectada de bajo riesgo a mosquito susceptible
    beta4 <- ((b*a4*I_V)/(Nh)), # Tasa de contagio mosquito infectado a persona susceptible de alto riesgo 
    beta5 <- ((b*a5*(I_H))/(Nh)) # Tasa de contagio persona infectada de alto riesgo a mosquito susceptible
    )
    
  
    cdmx <- ode(iniciales_cdmx, tiempo_cdmx, ZIKA_M, parms = pars_cdmx)
    
    plot(out,col="pink")
    par(mfrow=c(1,1))
    
    cdmx_zikam <- matplot(cdmx[ , 1], cdmx[ , 2:12], type="l", xlab = "Tiempo", ylab = "Población", 
                         main= "Gráfica ZIKA para CDMX", lwd = 2) 
    legend("topright", c("S alto riesgo", "E alto riesgo ", "I alto riesgo ", "R alto riesgo", 
                         "S vectores", "E vectores", "I vectores", 
                         "S bajo riesgo", "E bajo riesgo", "I bajo riesgo", "R bajo riesgo"), col = 1:11, lty=1:5, cex=0.5)

contact_rate_ZK_MX<- (beta1 + beta2 + beta3 + beta4 + beta5)
transmission_probability_ZK_MX<- (a1 + a2 + a3 + a4 + a5)
infectious_period_ZK_MX<- ifh
RO= contact_rate_ZK_MX * transmission_probability_ZK_MX * infectious_period_ZK_MX
c("RO=", R0)    
    
```



Para Veracruz

```{r}
ZIKA_veracruz <- function(times, state, pars) {
  with(as.list(c(state, pars)), {
    #Ecuaciones alto riesgo
    dS_H<- n_H*f*p_H - beta2*S_H*I_H*q - beta2*S_H*I_L - beta4*S_H*I_V - muh*S_H
    dE_H<- beta2*S_H*I_H*q + beta2*S_H*I_L + beta4*S_H*I_V - muh*E_H - alfa_H*E_H
    dI_H<- alfa_H*E_H + n_H*(1-p_H) - muh*I_H - tetha*I_H - gamma*I_H
    dR_H<- gamma*I_H - muh*R_H
    #Ecuaciones vectores
    dS_V<- n_V - beta3*S_V*I_L - beta5*S_V*I_H - muv*S_V
    dE_V<- beta3*S_V*I_L + beta5*S_V*I_H - muv*E_V - alfa_V*E_V
    dI_V<- alfa_V*E_V - muv*I_V
    #Ecuaciones bajo riesgo
    dS_L<- n_H*(1-f)*p_H - beta2*S_L*I_L*q - beta1*S_L*I_V - beta2*S_L*I_H - muh*S_L
    dE_L<- beta2*S_L*I_L*q + beta1*S_L*I_V + beta2*S_L*I_H - muh*E_L - alfa_H*E_L
    dI_L<- alfa_H*E_L + n_H*(1-p_H) - muh*I_L - tetha*I_L - gamma*I_L
    dR_L<- gamma*I_L - muh*R_L
    list(c(dS_H, dE_H, dI_H, dR_H, dS_V, dE_V, dI_V, dS_L, dE_L, dI_L, dR_L))
  })
}
  

  # TIEMPO
  times_veracruz <- seq(1, 200 , by = 1)
  
  
  # PARAMETROS
  parametro_veracruz <- c(
    Lv <- 8.5 + 35, #Esperanza de vida de mosquitos (dias)
    Lh <- 74.9 * 365, # Esperanza de vida de humanos (dias) #### MODIFICAR POR EDO ####
    iph <- 8.5, # Periodo de incubacion en humanos (dias)
    ipv <- 8.5, # Periodo de incubacion en mosquito (dias)
    ifh <- 4.5, # Periodo infeccioso en humanos (dias)
    muh <- 0.0016, # Mortalidad en humanos 
    muv <- 0.0064, # Mortalidad en vectores 
    alfa_H <- 1/iph, # Tasa de incubacion en humanos 
    alfa_V <- 1/ipv, # Tasa de incubacion en mosquitos
    gamma <- 1/ifh, # Tasa de recuperacion en humanos 
    n_H <- 0.0502, #Tasaa de natalidad humanos ##### MODIFICAR POR EDO ####
    n_V <- 0.099, # Tasa de natalidad mosquitos 
    tetha <- 0.005, # Tasa de letalidad asociada a zika
    q <- 0.25, # Proporcion de la poblacion que usa condon #### ESTIMADO ####
    p_H <- 0.867, #   Proporcion de la poblacion que nace libre de zika 
    f <- 0, # Proporcion de nacidos que se dirigen al grupo de alto riesgo #### ESTIMADO ####
    b <- 0.45, #Tasa de picadura de mosquito
    a1 <- 0.044, # Probabilidad de transmision, picadura de mosquito infectado a humano susceptible de bajo riesgo (LV)
    a2 <- 0.047, # Probabilidad de transmision, picadura de mosquito susceptible a humano infectado de bajo riesgo (VL)
    a3 <- 0.033, # Probabilidad de transmision por contacto sexual entre humanos susceptibles e infectados (S-I humanos)
    a4 <- 0.0616, # Probabilidad de transmision, mosquito infectado a humano susceptible de alto riesgo (HV)
    a5 <- 0.0658, # Probabilidad de transmision, mosquito susceptible a humano infectado de alto riesgo (VH)
    c <- 0.0055, # contacto sexual entre humano susceptible y humano infectado 
    Nh <- 8063000, # Poblacion total de humanos  #### MODIFICAR POR EDO ####
    beta1 <- (b*a1*I_V)/Nh, # Tasa de contagio mosquito infectado a persona susceptible de bajo riesgo
    beta2 <- ((c*a3*(I_H + I_L))/(Nh)), # Tasa de contagio de persona infectada a persona susceptible  
    beta3 <- ((b*a2*(I_L))/(Nh)), # Tasa de contagio persona infectada de bajo riesgo a mosquito susceptible
    beta4 <- ((b*a4*I_V)/(Nh)), # Tasa de contagio mosquito infectado a persona susceptible de alto riesgo 
    beta5 <- ((b*a5*(I_H))/(Nh)) # Tasa de contagio persona infectada de alto riesgo a mosquito susceptible
  )
    
    # CONDICIONES INICIALES
    cond_ini_veracruz <-c( 
      S_H = 1500000,
      E_H = 950000,
      I_H = 900000,
      R_H = 1100000,
      S_V = 904000,
      E_V = 690000,
      I_V = 969000,
      S_L = 1000000,
      E_L = 850000, 
      I_L = 863000,  
      R_L = 900000)
    

    out_veracruz <- ode(y=cond_ini,
               times=times,
               fun = ZIKA_veracruz, 
               parms  = parametro)
    
    plot(out_veracruz,col="pink")
    par(mfrow=c(1,1))
    
    graficaTG <- matplot(out_veracruz[ , 1], out_veracruz[ , 2:8], type="l", xlab = "tiempo", ylab = "Poblacion", 
                         main= "Grafica ZIKA", lwd = 2) 
    legend("topright", c("Sh", "Eh", "Ih", "Rh", "Sv", "Ev", "Iv"), col =1:5, lty=1:5, cex=0.5)

contact_rate_ZK_V<- (beta1 + beta2 + beta3 + beta4 + beta5)
transmission_probability_ZK_V<- (a1 + a2 + a3 + a4 + a5)
infectious_period_ZK_V<- ifh
RO= contact_rate_ZK_V * transmission_probability_ZK_V * infectious_period_ZK_V
c("RO=", R0)
    
```

