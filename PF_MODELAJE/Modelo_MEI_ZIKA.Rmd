---
title: "Modelo_ZIKA_Completo"
author: "Melisa Lachira Maya"
date: "2023-11-17"
output: html_document
---
# Modelo ZIKA

## Formulas

Alto riesgo

Vectores

Bajo riesgo


```{r}
library(deSolve)
ZIKA_M <- function(times, state, pars) {
  with(as.list(c(state, pars)), {
    #Ecuaciones alto riesgo
    dS_H<- n_H*f*p_H - beta2*S_H*I_H*q - beta2*S_H*I_L - beta4*S_H*I_V - muh*S_H
    dE_H<- beta2*S_H*I_H*q + beta2*S_H*I_L + beta4*S_H*I_V - muh*E_H - alfa_H*E_H
    dI_H<- alfa_H*E_H + n_H*(1-p_H) - muh*I_H - tetha*I_H - gamma*I_H
    dR_H<- gamma*I_H - muh*R_H
    #Ecuaciones vectores
    dS_V<- n_V - beta3*S_V*I_L - beta5*S_V*I_H - muv*S_V
    dE_V<- beta3*S_V*I_L + beta5*S_V*I_H - muv*E_V - alfa_V*E_V
    dI_V<- alfa_V*E_V - muv*I_V
    #Ecuaciones bajo riesgo
    dS_L<- n_H*(1-f)*p_H - beta2*S_L*I_L*q - beta1*S_L*I_V - beta2*S_L*I_H - muh*S_L
    dE_L<- beta2*S_L*I_L*q + beta1*S_L*I_V + beta2*S_L*I_H - muh*E_L - alfa_H*E_L
    dI_L<- alfa_H*E_L + n_H*(1-p_H) - muh*I_L - tetha*I_L - gamma*I_L
    dR_L<- gamma*I_L - muh*R_L
    list(c(dS_H, dE_H, dI_H, dR_H, dS_V, dE_V, dI_V, dS_L, dE_L, dI_L, dR_L))
  })
}

```

```{r}
# TIEMPO
times<- seq(1, 200 , by = 1)

# CONDICIONES INICIALES
cond_ini<-c( 
  S_H = 0,
  E_H = 0,
  I_H = 0,
  R_H = 0,
  S_V = 0,
  E_V = 0,
  I_V = 0,
  S_L = 0,
  E_L = 0, 
  I_L = 0,  
  R_L = 0)


# PARAMETROS
parametro<- c(
Lv <- 8.5 + 35, #Esperanza de vida de mosquitos (dias)
Lh <- 0, # Esperanza de vida de humanos (dias) #### MODIFICAR POR EDO ####
iph <- 8.5, # Periodo de incubacion en humanos (dias)
ipv <- 8.5, # Periodo de incubacion en mosquito (dias)
ifh <- 4.5, # Periodo infeccioso en humanos (dias)
muh <- 0.0016, # Mortalidad en humanos 
muv <- 0.0064, # Mortalidad en vectores 
alfa_H <- 1/iph, # Tasa de incubacion en humanos 
alfa_V <- 1/ipv, # Tasa de incubacion en mosquitos
gamma <- 1/ifh, # Tasa de recuperacion en humanos 
n_H <- 0, # Tasa de natalidad humanos ##### MODIFICAR POR EDO ####
n_V <- 0.099, # Tasa de natalidad mosquitos 
tetha <- 0.005, # Tasa de letalidad asociada a zika
q <- 0.25, # Proporcion de la poblacion que usa condon #### ESTIMADO ####
p_H <- 0.867, #   Proporcion de la poblacion que nace libre de zika 
f <- 0, # Proporcion de nacidos que se dirigen al grupo de alto riesgo #### ESTIMADO ####
b <- 0.45, #Tasa de picadura de mosquito
a1 <- 0.044, # Probabilidad de transmision, picadura de mosquito infectado a humano susceptible de bajo riesgo (LV)
a2 <- 0.047, # Probabilidad de transmision, picadura de mosquito susceptible a humano infectado de bajo riesgo (VL)
a3 <- 0.033, # Probabilidad de transmision por contacto sexual entre humanos susceptibles e infectados (S-I humanos)
a4 <- 0.0616, # Probabilidad de transmision, mosquito infectado a humano susceptible de alto riesgo (HV)
a5 <- 0.0658, # Probabilidad de transmision, mosquito susceptible a humano infectado de alto riesgo (VH)
c <- 0.0055, # contacto sexual entre humano susceptible y humano infectado 
Nh <- 0 # Poblacion total de humanos  #### MODIFICAR POR EDO ####
beta1 <- (b*a1*I_V)/Nh, # Tasa de contagio mosquito infectado a persona susceptible de bajo riesgo
beta2 <- ((c*a3*(I_H + I_L))/(Nh)), # Tasa de contagio de persona infectada a persona susceptible  
beta3 <- ((b*a2*(I_L))/(Nh)), # Tasa de contagio persona infectada de bajo riesgo a mosquito susceptible
beta4 <- ((b*a4*I_V)/(Nh)), # Tasa de contagio mosquito infectado a persona susceptible de alto riesgo 
beta5 <- ((b*a5*(I_H))/(Nh)) # Tasa de contagio persona infectada de alto riesgo a mosquito susceptible
    )


```

```{r}

out <- ode(y=cond_ini,
           times=times,
           fun = ZIKA_M, 
           parms  = parametro)

plot(out,col="pink")
par(mfrow=c(1,1))

graficaTG <- matplot(out[ , 1], out[ , 2:8], type="l", xlab = "tiempo", ylab = "Población", 
                     main= "Gráfica ZIKA", lwd = 2) 
legend("topright", c("Sh", "Eh", "Ih", "Rh", "Sv", "Ev", "Iv"), col =1:5, lty=1:5, cex=0.5)
```

